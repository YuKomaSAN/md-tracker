# MD Tracker 利用マニュアル

MD Trackerは、遊戯王マスターデュエルの対戦結果（勝敗、コイントス、手番など）を自動で記録・分析するツールです。
ブラウザだけで動作しますが、データの保存には**Googleスプレッドシート**を使用するため、最初に一度だけセットアップが必要です。

## 1. 準備するもの

*   PC (Windows/Mac)
*   Google Chrome ブラウザ
*   Google アカウント（スプレッドシート作成用）

## 2. セットアップ手順 (初回のみ)

あなたの対戦データを保存するための「バックエンド（裏方）」を準備します。
**テンプレート（ひな形）** を用意したので、コピーするだけで簡単に作成できます。

### Step 1: テンプレートのコピー

1.  以下のリンクをクリックして、スプレッドシートのテンプレートを開きます。
    *   👉 **[MD Tracker テンプレート (Google Sheets)](https://docs.google.com/spreadsheets/d/1Hvy_Lub-ymZePA5XCk-7IHjIvkObJ1Coe5M8mRxrDhQ/edit?usp=sharing)**
2.  画面左上のメニューから **「ファイル」** > **「コピーを作成」** をクリックします。
3.  名前を「MD Tracker Log」など好きな名前に変更し、**「コピーを作成」** を押します。
    *   これで、あなたのGoogleドライブに専用のシートが作成されました。

### Step 2: ウェブアプリとしてデプロイ

コピーしたシートには、すでにプログラム（GAS）が組み込まれています。これを有効化します。

1.  コピーしたシートのメニューから **「拡張機能」** > **「Apps Script」** をクリックします。
2.  新しいタブでスクリプトエディタが開きます。
3.  画面右上の **「デプロイ」** ボタン > **「新しいデプロイ」** をクリックします。
4.  左上の歯車アイコン（⚙️） > **「ウェブアプリ」** を選択します。
5.  以下の設定を入力します：
    *   **説明:** `MD Tracker Backend` （何でもOK）
    *   **次のユーザーとして実行:** **「自分」** (Me)
    *   **アクセスできるユーザー:** **「全員」** (Anyone)
        *   *注意: 「全員」にしても、URLを知らない他人が勝手にアクセスすることは事実上できません。アプリからデータを書き込むために必要です。*
6.  **「デプロイ」** をクリックします。
7.  「アクセスを承認」という画面が出たら：
    *   「アクセスを承認」をクリック -> 自分のアカウントを選択 -> 「このアプリはGoogleによって確認されていません」と出たら左下の **「詳細」** を押し、**「(プロジェクト名)（安全ではないページ）に移動」** をクリック -> **「許可」** を押します。
8.  **「ウェブアプリ」** の下に表示される **URL** （`https://script.google.com/macros/s/.../exec`）をコピーします。
    *   これがあなたの専用の「データ保存用URL」です。

### Step 3: アプリとの連携

1.  [MD Tracker アプリページ](https://yukomasan.github.io/md-tracker/) にアクセスします。
2.  画面上部の入力欄に、先ほどコピーした **GAS URL** を貼り付けます。
3.  **「保存」** ボタンを押します。
4.  「保存しました」と表示されれば設定完了です！

## 3. 使い方

### 対戦を記録する

1.  **「🚀 MD画面取得」** ボタンを押します。
2.  画面共有の選択画面が出るので、**「Master Duel」のウィンドウ** を選択して「共有」を押します。
    *   *ポイント:* ゲーム画面は隠れていても（他のウィンドウの下にあっても）大丈夫ですが、最小化はしないでください。
3.  あとは普通にデュエルするだけ！
    *   コイントス画面で「先攻/後攻」を自動判定します。
    *   対戦終了時の「VICTORY / LOSE」を検知して自動で記録します。

### データを分析する

*   **「📊 分析」タブ:** 勝率や先攻率、デッキごとの相性などをグラフや表で確認できます。
*   **フィルタ機能:** 「直近24時間」「今週」などでデータを絞り込めます。

### 便利な機能

*   **PiPモード (Picture-in-Picture):**
    *   「📱 ミニUI表示」ボタンを押すと、操作パネルが小さな縦長ウィンドウに切り替わります。
    *   ゲーム画面の横に置いておけば、邪魔にならずに状況を確認できます。

## 4. よくある質問

*   **Q. うまく記録されない**
    *   A. ゲーム内の文字サイズや解像度によってはOCR（文字認識）が失敗することがあります。ゲーム画面を標準的なサイズ（1920x1080など）に戻して試してみてください。
*   **Q. データはどこに保存されている？**
    *   A. Step 1でコピーしたあなたのGoogleスプレッドシートに保存されています。シートを直接開いて編集することも可能です。
