# MD Tracker 利用マニュアル

MD Trackerは、遊戯王マスターデュエルの対戦結果（勝敗、コイントス、手番など）を自動で記録・分析するツールです。
ブラウザだけで動作しますが、データの保存には**Googleスプレッドシート**を使用するため、最初に一度だけセットアップが必要です。

## 1. 準備するもの

*   PC (Windows/Mac)
*   Google Chrome ブラウザ
*   Google アカウント（スプレッドシート作成用）

## 2. セットアップ手順 (初回のみ)

あなたの対戦データを保存するための「バックエンド（裏方）」を準備します。
少し手順が多いですが、画像を見ながら進めてください。

### Step 1: Googleスプレッドシートの作成

1.  [Googleスプレッドシート](https://docs.google.com/spreadsheets/) にアクセスし、「空白」の新しいシートを作成します。
2.  シートの名前（左上の「無題のスプレッドシート」）を `MD Tracker Log` など、わかりやすい名前に変更します。
3.  画面下部のシートタブ（「シート1」となっている部分）をダブルクリックし、名前を **`Log`** に変更します。
4.  「+」ボタンを押して新しいシートを追加し、その名前を **`Config`** に変更します。
    *   **重要:** シート名は正確に `Log` と `Config` にしてください（大文字・小文字区別）。

### Step 2: スクリプトの登録

1.  スプレッドシートのメニューから **「拡張機能」** > **「Apps Script」** をクリックします。
2.  新しいタブでスクリプトエディタが開きます。
3.  もともと書かれている `function myFunction() {...}` をすべて消して、空にします。
4.  以下のリンク先のコードをすべてコピーして、エディタに貼り付けます。
    *   [👉 GASスクリプトコードはこちら](../gas/コード.js)
    *   (リンク先のファイルの中身をすべてコピーしてください)
5.  ツールバーのフロッピーアイコン（💾）を押して保存します（プロジェクト名は適当でOKです）。

### Step 3: ウェブアプリとしてデプロイ

1.  画面右上の **「デプロイ」** ボタン > **「新しいデプロイ」** をクリックします。
2.  左上の歯車アイコン（⚙️） > **「ウェブアプリ」** を選択します。
3.  以下の設定を入力します：
    *   **説明:** `MD Tracker Backend` （何でもOK）
    *   **次のユーザーとして実行:** **「自分」** (Me)
    *   **アクセスできるユーザー:** **「全員」** (Anyone)
        *   *注意: 「全員」にしても、URLを知らない他人が勝手にアクセスすることは事実上できません。アプリからデータを書き込むために必要です。*
4.  **「デプロイ」** をクリックします。
5.  「アクセスを承認」という画面が出たら：
    *   「アクセスを承認」をクリック -> 自分のアカウントを選択 -> 「このアプリはGoogleによって確認されていません」と出たら左下の **「詳細」** を押し、**「(プロジェクト名)（安全ではないページ）に移動」** をクリック -> **「許可」** を押します。
6.  **「ウェブアプリ」** の下に表示される **URL** （`https://script.google.com/macros/s/.../exec`）をコピーします。
    *   これがあなたの専用の「データ保存用URL」です。

### Step 4: アプリとの連携

1.  [MD Tracker アプリページ](https://yukomasan.github.io/md-tracker/) (※URLは公開後に確定) にアクセスします。
2.  画面上部の入力欄に、先ほどコピーした **GAS URL** を貼り付けます。
3.  **「保存」** ボタンを押します。
4.  「保存しました」と表示されれば設定完了です！

## 3. 使い方

### 対戦を記録する

1.  **「画面監視を開始」** ボタンを押します。
2.  画面共有の選択画面が出るので、**「Master Duel」のウィンドウ** を選択して「共有」を押します。
    *   *ポイント:* ゲーム画面は隠れていても（他のウィンドウの下にあっても）大丈夫ですが、最小化はしないでください。
3.  あとは普通にデュエルするだけ！
    *   コイントス画面で「先攻/後攻」を自動判定します。
    *   対戦終了時の「VICTORY / LOSE」を検知して自動で記録します。

### データを分析する

*   **「分析モード」タブ:** 勝率や先攻率、デッキごとの相性などをグラフや表で確認できます。
*   **フィルタ機能:** 「直近24時間」「今週」などでデータを絞り込めます。

### 便利な機能

*   **PiPモード (Picture-in-Picture):**
    *   「PiPモード」ボタンを押すと、操作パネルが小さな縦長ウィンドウに切り替わります。
    *   ゲーム画面の横に置いておけば、邪魔にならずに状況を確認できます。

## 4. よくある質問

*   **Q. うまく記録されない**
    *   A. ゲーム内の文字サイズや解像度によってはOCR（文字認識）が失敗することがあります。ゲーム画面を標準的なサイズ（1920x1080など）に戻して試してみてください。
*   **Q. データはどこに保存されている？**
    *   A. Step 1で作成したあなたのGoogleスプレッドシートに保存されています。シートを直接開いて編集することも可能です。
